import { expect, test, describe, it } from "vitest";
import {
  getBlocksInRangeBatched,
  getDailyTransactionCounts30Days,
  getLatestFinalizedBlock,
  getLatestWalletTransactions,
  rangeBigInt,
} from "./eth";

describe("getDailyTransactionCounts30Days", () => {
  test("type and row count", async () => {
    const res = await getDailyTransactionCounts30Days();
    expect(res).toHaveLength(31);
    expect(res[0]).toHaveProperty("day");
    expect(res[0].day).toBeTypeOf("string");
    expect(res[0]).toHaveProperty("transaction_count");
    expect(res[0].transaction_count).toBeTypeOf("number");
  });
});

describe("getLatestFinalizedBlock", () => {
  test("type", async () => {
    const res = await getLatestFinalizedBlock();
    expect(res).toBeTypeOf("bigint");
  });
});

describe("getBlocksInRangeBatched", () => {
  test("range 1000000 - 1000001", async () => {
    const res = await getBlocksInRangeBatched({
      start: BigInt(1000000),
      end: BigInt(1000001),
    });
    expect(res).toMatchInlineSnapshot(`
      [
        {
          "baseFeePerGas": null,
          "blobGasUsed": undefined,
          "difficulty": 12549332509227n,
          "excessBlobGas": undefined,
          "extraData": "0xd783010303844765746887676f312e352e31856c696e7578",
          "gasLimit": 3141592n,
          "gasUsed": 50244n,
          "hash": "0x8e38b4dbf6b11fcc3b9dee84fb7986e29ca0a02cecd8977c161ff7333329681e",
          "logsBloom": "0x00000000000000000000000000000000000800000000000000000000000800000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000",
          "miner": "0x2a65aca4d5fc5b5c859090a6c34d164135398226",
          "mixHash": "0x92c4129a0ae2361b452a9edeece55c12eceeab866316195e3d87fc1b005b6645",
          "nonce": "0xcd4c55b941cf9015",
          "number": 1000000n,
          "parentHash": "0xb4fbadf8ea452b139718e2700dc1135cfc81145031c84b7ab27cd710394f7b38",
          "receiptsRoot": "0x20e3534540caf16378e6e86a2bf1236d9f876d3218fbc03958e6db1c634b2333",
          "sha3Uncles": "0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",
          "size": 768n,
          "stateRoot": "0x0e066f3c2297a5cb300593052617d1bca5946f0caa0635fdb1b85ac7e5236f34",
          "timestamp": 1455404053n,
          "totalDifficulty": null,
          "transactions": [
            {
              "blockHash": "0x8e38b4dbf6b11fcc3b9dee84fb7986e29ca0a02cecd8977c161ff7333329681e",
              "blockNumber": 1000000n,
              "chainId": undefined,
              "from": "0x39fa8c5f2793459d6622857e7d9fbb4bd91766d3",
              "gas": 129244n,
              "gasPrice": 80525500000n,
              "hash": "0xea1093d492a1dcb1bef708f771a99a96ff05dcab81ca76c31940300177fcf49f",
              "input": "0x",
              "nonce": 21,
              "r": "0xa254fe085f721c2abe00a2cd244110bfc0df5f4f25461c85d8ab75ebac11eb10",
              "s": "0x30b7835ba481955b20193a703ebc5fdffeab081d63117199040cdf5a91c68765",
              "to": "0xc083e9947cf02b8ffc7d3090ae9aea72df98fd47",
              "transactionIndex": 0,
              "type": "legacy",
              "typeHex": "0x0",
              "v": 28n,
              "value": 100000000000000000000n,
            },
            {
              "blockHash": "0x8e38b4dbf6b11fcc3b9dee84fb7986e29ca0a02cecd8977c161ff7333329681e",
              "blockNumber": 1000000n,
              "chainId": undefined,
              "from": "0x32be343b94f860124dc4fee278fdcbd38c102d88",
              "gas": 50000n,
              "gasPrice": 60000000000n,
              "hash": "0xe9e91f1ee4b56c0df2e9f06c2b8c27c6076195a88a7b8537ba8313d80e6f124e",
              "input": "0x",
              "nonce": 17387,
              "r": "0x3b08715b4403c792b8c7567edea634088bedcd7f60d9352b1f16c69830f3afd5",
              "s": "0x10b9afb67d2ec8b956f0e1dbc07eb79152904f3a7bf789fc869db56320adfe09",
              "to": "0xdf190dc7190dfba737d7777a163445b7fff16133",
              "transactionIndex": 1,
              "type": "legacy",
              "typeHex": "0x0",
              "v": 28n,
              "value": 437194980000000000n,
            },
          ],
          "transactionsRoot": "0x65ba887fcb0826f616d01f736c1d2d677bcabde2f7fc25aa91cfbc0b3bad5cb3",
          "uncles": [],
        },
        {
          "baseFeePerGas": null,
          "blobGasUsed": undefined,
          "difficulty": 12555460113247n,
          "excessBlobGas": undefined,
          "extraData": "0xd783010303844765746887676f312e352e31856c696e7578",
          "gasLimit": 3141592n,
          "gasUsed": 21000n,
          "hash": "0xcb5cab7266694daa0d28cbf40496c08dd30bf732c41e0455e7ad389c10d79f4f",
          "logsBloom": "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
          "miner": "0x2a65aca4d5fc5b5c859090a6c34d164135398226",
          "mixHash": "0xd5332614a151dd917b84fc5ff62580d7099edb7c37e0ac843d873de978d50352",
          "nonce": "0x9112b8c2b377fbe8",
          "number": 1000001n,
          "parentHash": "0x8e38b4dbf6b11fcc3b9dee84fb7986e29ca0a02cecd8977c161ff7333329681e",
          "receiptsRoot": "0xb873ddefdb56d448343d13b188241a4919b2de10cccea2ea573acf8dbc839bef",
          "sha3Uncles": "0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",
          "size": 658n,
          "stateRoot": "0x7dd4aabb93795feba9866821c0c7d6a992eda7fbdd412ea0f715059f9654ef23",
          "timestamp": 1455404058n,
          "totalDifficulty": null,
          "transactions": [
            {
              "blockHash": "0xcb5cab7266694daa0d28cbf40496c08dd30bf732c41e0455e7ad389c10d79f4f",
              "blockNumber": 1000001n,
              "chainId": undefined,
              "from": "0x2a65aca4d5fc5b5c859090a6c34d164135398226",
              "gas": 90000n,
              "gasPrice": 50000000000n,
              "hash": "0xefb6c796269c0d1f15fdedb5496fa196eb7fb55b601c0fa527609405519fd581",
              "input": "0x",
              "nonce": 172321,
              "r": "0x98c6475188a4d0a5746b86f7ee9c61c2c9b6aaaf81f47172a14910d69292e902",
              "s": "0x32354fa0b065cea823562b2bc6ab631a61b226d42aa3995371aeb3b0a06ae45d",
              "to": "0x819f4b08e6d3baa33ba63f660baed65d2a6eb64c",
              "transactionIndex": 0,
              "type": "legacy",
              "typeHex": "0x0",
              "v": 27n,
              "value": 1048850240000000000n,
            },
          ],
          "transactionsRoot": "0xc61c50a0a2800ddc5e9984af4e6668de96aee1584179b3141f458ffa7d4ecec6",
          "uncles": [],
        },
      ]
    `);
  });
});

describe("rangeBigInt", () => {
  it("should generate a range from BigInt(1) to BigInt(5)", () => {
    expect(rangeBigInt(BigInt(1), BigInt(5))).toEqual([
      BigInt(1),
      BigInt(2),
      BigInt(3),
      BigInt(4),
      BigInt(5),
    ]);
  });

  it("should generate a range from BigInt(0) to BigInt(0)", () => {
    expect(rangeBigInt(BigInt(0), BigInt(0))).toEqual([BigInt(0)]);
  });

  it("should handle large BigInts", () => {
    expect(
      rangeBigInt(BigInt("999999999999999999"), BigInt("1000000000000000001")),
    ).toEqual([
      BigInt("999999999999999999"),
      BigInt("1000000000000000000"),
      BigInt("1000000000000000001"),
    ]);
  });

  it("should throw if end < start", () => {
    expect(() => rangeBigInt(BigInt(10), BigInt(5))).toThrow(
      "End must be greater than or equal to start",
    );
  });
});

describe("getLatestWalletTransactions", () => {
  test("type, address 0x95222290dd7278aa3ddd389cc1e1d165cc4bafe5", async () => {
    const res = await getLatestWalletTransactions({
      address: "0x95222290dd7278aa3ddd389cc1e1d165cc4bafe5",
    });
    expect(res).toMatchInlineSnapshot(`
      {
        "cursor": "eyJhbGciOiJIUzI1NiJ9.eyJ0YWJsZUluZGV4IjowLCJsYXN0RXZhbHVhdGVkS2V5Ijp7InRpbWVfdHhJbmRleCI6IjAwMDE3NDc0NDg3MTEwMDAwMDE2MCIsIndhbGxldEFkZHJlc3MiOiIweDk1MjIyMjkwZGQ3Mjc4YWEzZGRkMzg5Y2MxZTFkMTY1Y2M0YmFmZTUifSwicGFnZU51bWJlciI6MCwia2V5Q29uZGl0aW9uRXhwcmVzc2lvbiI6eyJ3YWxsZXRBZGRyZXNzIjp7ImVxIjoiMHg5NTIyMjI5MGRkNzI3OGFhM2RkZDM4OWNjMWUxZDE2NWNjNGJhZmU1In0sInRpbWVfdHhJbmRleCI6eyJiZXR3ZWVuIjpbIjAwMDE0MzgyNjk5NzMwMDAwMDAwMCIsIjAwMDE3NDc0NDk2OTUwMDEwMDAwMCJdfX0sImxpbWl0IjoiMjAiLCJvcmRlciI6ImRlc2NlbmRpbmcifQ.Ui-EgoXRdcgndkmfDd11hbCEATIvfaSk9aZrT07CkY0",
        "page": 0,
        "page_size": 20,
        "result": [
          {
            "block_hash": "0x5e2fd3972e05540daadc2c4a62f6b4480ade755ecb857a1141c8b6d3ac7fbaea",
            "block_number": "22499845",
            "block_timestamp": "2025-05-17T02:40:47.000Z",
            "from_address": "0x95222290dd7278aa3ddd389cc1e1d165cc4bafe5",
            "from_address_entity": null,
            "from_address_entity_logo": null,
            "from_address_label": "beaverbuild",
            "gas": "23712",
            "gas_price": "1314043158",
            "hash": "0xb81b700f80ff4215a34a4751c16dc2dc4d1a00b699854b66e7633a4d72620f46",
            "input": "0x",
            "nonce": "2507796",
            "receipt_contract_address": null,
            "receipt_cumulative_gas_used": "35399651",
            "receipt_gas_used": "23712",
            "receipt_root": null,
            "receipt_status": "1",
            "to_address": "0x7dc14addc6c84bc650aa43b467e6c7b317257007",
            "to_address_entity": null,
            "to_address_entity_logo": null,
            "to_address_label": null,
            "transaction_fee": "0.000031158591362496",
            "transaction_index": "430",
            "transfer_index": [
              22499845,
              430,
            ],
            "value": "59757086606545434",
          },
          {
            "block_hash": "0xab2a0945295359b9ea62db594fa5b7c14d4f767be483252e058d79124bc9fea9",
            "block_number": "22499838",
            "block_timestamp": "2025-05-17T02:39:23.000Z",
            "from_address": "0x95222290dd7278aa3ddd389cc1e1d165cc4bafe5",
            "from_address_entity": null,
            "from_address_entity_logo": null,
            "from_address_label": "beaverbuild",
            "gas": "21000",
            "gas_price": "1521695360",
            "hash": "0x92863805906b6394e2ae26b54828837052f66fe489d9b87f8990bfb8e6d8af46",
            "input": "0x",
            "nonce": "2507795",
            "receipt_contract_address": null,
            "receipt_cumulative_gas_used": "20060535",
            "receipt_gas_used": "21000",
            "receipt_root": null,
            "receipt_status": "1",
            "to_address": "0x8696e84ab5e78983f2456bcb5c199eea9648c8c2",
            "to_address_entity": null,
            "to_address_entity_logo": null,
            "to_address_label": null,
            "transaction_fee": "0.00003195560256",
            "transaction_index": "274",
            "transfer_index": [
              22499838,
              274,
            ],
            "value": "37724618055303232",
          },
          {
            "block_hash": "0x47764e028eb22c4f7c82019c88b7d43148040f76e81c963441e5a397e5332116",
            "block_number": "22499829",
            "block_timestamp": "2025-05-17T02:37:35.000Z",
            "from_address": "0x95222290dd7278aa3ddd389cc1e1d165cc4bafe5",
            "from_address_entity": null,
            "from_address_entity_logo": null,
            "from_address_label": "beaverbuild",
            "gas": "23100",
            "gas_price": "1634951659",
            "hash": "0xdf07b65e98e4d5c13af95b53357b55b20fed70fcfc7209f46ae8f728f8e755d2",
            "input": "0x",
            "nonce": "2507794",
            "receipt_contract_address": null,
            "receipt_cumulative_gas_used": "13010082",
            "receipt_gas_used": "21055",
            "receipt_root": null,
            "receipt_status": "1",
            "to_address": "0xd4e96ef8eee8678dbff4d535e033ed1a4f7605b7",
            "to_address_entity": "Rocket Pool",
            "to_address_entity_logo": "https://entities-logos.s3.us-east-1.amazonaws.com/rocket_pool.png",
            "to_address_label": "Rocket Pool Smoothing Pool",
            "transaction_fee": "0.000034423907180245",
            "transaction_index": "121",
            "transfer_index": [
              22499829,
              121,
            ],
            "value": "63525982803018704",
          },
          {
            "block_hash": "0xb3c6a73f1146ec94ee4561c89b5c924acc8c1ec94b2ca6d79159b4e97f6043b8",
            "block_number": "22499824",
            "block_timestamp": "2025-05-17T02:36:35.000Z",
            "from_address": "0x95222290dd7278aa3ddd389cc1e1d165cc4bafe5",
            "from_address_entity": null,
            "from_address_entity_logo": null,
            "from_address_label": "beaverbuild",
            "gas": "22111",
            "gas_price": "1715526769",
            "hash": "0x08d91bea1eeef835fd990b7de0a5ec797b0eb68428a285d35dee4d4685693a9c",
            "input": "0x",
            "nonce": "2507793",
            "receipt_contract_address": null,
            "receipt_cumulative_gas_used": "15077626",
            "receipt_gas_used": "22111",
            "receipt_root": null,
            "receipt_status": "1",
            "to_address": "0x388c818ca8b9251b393131c08a736a67ccb19297",
            "to_address_entity": "Lido",
            "to_address_entity_logo": "https://entities-logos.s3.us-east-1.amazonaws.com/lido.png",
            "to_address_label": "Lido: Execution Layer Rewards Vault",
            "transaction_fee": "0.000037932012389359",
            "transaction_index": "190",
            "transfer_index": [
              22499824,
              190,
            ],
            "value": "20355831208928119",
          },
          {
            "block_hash": "0x0fe4b561ed71f0cda4f08b54991fc5b73cc8f4aa6503bc6295ab8de9812a7759",
            "block_number": "22499818",
            "block_timestamp": "2025-05-17T02:35:23.000Z",
            "from_address": "0x95222290dd7278aa3ddd389cc1e1d165cc4bafe5",
            "from_address_entity": null,
            "from_address_entity_logo": null,
            "from_address_label": "beaverbuild",
            "gas": "21000",
            "gas_price": "1681487614",
            "hash": "0x94199c2a4d0c772431b8bd7209b2db4ca969db7115a03d343e842001bfb9ec73",
            "input": "0x",
            "nonce": "2507792",
            "receipt_contract_address": null,
            "receipt_cumulative_gas_used": "19388228",
            "receipt_gas_used": "21000",
            "receipt_root": null,
            "receipt_status": "1",
            "to_address": "0x4675c7e5baafbffbca748158becba61ef3b0a263",
            "to_address_entity": null,
            "to_address_entity_logo": null,
            "to_address_label": "Fee Recipient: 0x467...263",
            "transaction_fee": "0.000035311239894",
            "transaction_index": "245",
            "transfer_index": [
              22499818,
              245,
            ],
            "value": "18557497035822562",
          },
          {
            "block_hash": "0x36f21fa68cafb57b8da27b49909d46983573def2f793b3a3eb931ef5b0be0675",
            "block_number": "22499816",
            "block_timestamp": "2025-05-17T02:34:59.000Z",
            "from_address": "0x95222290dd7278aa3ddd389cc1e1d165cc4bafe5",
            "from_address_entity": null,
            "from_address_entity_logo": null,
            "from_address_label": "beaverbuild",
            "gas": "21000",
            "gas_price": "1643777649",
            "hash": "0x6608487b93c451c57d703d462941b525aae8784c28c6f1d3b56e4c1d152aa6a0",
            "input": "0x",
            "nonce": "2507791",
            "receipt_contract_address": null,
            "receipt_cumulative_gas_used": "24454530",
            "receipt_gas_used": "21000",
            "receipt_root": null,
            "receipt_status": "1",
            "to_address": "0xe455036e2f3a26df7014b7dbf6cedbbf81433478",
            "to_address_entity": null,
            "to_address_entity_logo": null,
            "to_address_label": null,
            "transaction_fee": "0.000034519330629",
            "transaction_index": "324",
            "transfer_index": [
              22499816,
              324,
            ],
            "value": "436594713633530462",
          },
          {
            "block_hash": "0xd48850944478d770aa4d6903f20846f65d2cabe6814dd5f6f7e66dc9c03af5fc",
            "block_number": "22499810",
            "block_timestamp": "2025-05-17T02:33:47.000Z",
            "from_address": "0x95222290dd7278aa3ddd389cc1e1d165cc4bafe5",
            "from_address_entity": null,
            "from_address_entity_logo": null,
            "from_address_label": "beaverbuild",
            "gas": "31118",
            "gas_price": "1742381410",
            "hash": "0x2a623e20423ecc6844dd30554071904159fd0a01187a1dcd7879c3398eddce78",
            "input": "0x",
            "nonce": "2507790",
            "receipt_contract_address": null,
            "receipt_cumulative_gas_used": "19335701",
            "receipt_gas_used": "31118",
            "receipt_root": null,
            "receipt_status": "1",
            "to_address": "0x5c4d4a148c4b504fab5782da4da93d69d098b207",
            "to_address_entity": null,
            "to_address_entity_logo": null,
            "to_address_label": null,
            "transaction_fee": "0.00005421942471638",
            "transaction_index": "261",
            "transfer_index": [
              22499810,
              261,
            ],
            "value": "25555722702438384",
          },
          {
            "block_hash": "0xd48850944478d770aa4d6903f20846f65d2cabe6814dd5f6f7e66dc9c03af5fc",
            "block_number": "22499810",
            "block_timestamp": "2025-05-17T02:33:47.000Z",
            "from_address": "0x95222290dd7278aa3ddd389cc1e1d165cc4bafe5",
            "from_address_entity": null,
            "from_address_entity_logo": null,
            "from_address_label": "beaverbuild",
            "gas": "21000",
            "gas_price": "1742381410",
            "hash": "0x78d37cba9bd746785f2e02b89bbb651a06e0c4f96c1a4ee4ef298742516a7711",
            "input": "0x",
            "nonce": "2507789",
            "receipt_contract_address": null,
            "receipt_cumulative_gas_used": "7244769",
            "receipt_gas_used": "21000",
            "receipt_root": null,
            "receipt_status": "1",
            "to_address": "0x6bf97afe2d2c790999cded2a8523009eb8a0823f",
            "to_address_entity": null,
            "to_address_entity_logo": null,
            "to_address_label": null,
            "transaction_fee": "0.00003659000961",
            "transaction_index": "56",
            "transfer_index": [
              22499810,
              56,
            ],
            "value": "8155577100597474",
          },
          {
            "block_hash": "0xeafdb777dfdaf541268cdfb30faa3030948896d6e58b7be8605934c942f14ffb",
            "block_number": "22499806",
            "block_timestamp": "2025-05-17T02:32:59.000Z",
            "from_address": "0x95222290dd7278aa3ddd389cc1e1d165cc4bafe5",
            "from_address_entity": null,
            "from_address_entity_logo": null,
            "from_address_label": "beaverbuild",
            "gas": "40963",
            "gas_price": "1736572006",
            "hash": "0x1e3a6ebbdb7d166cdb6ffbfbf7083393fd2441cfc03e84e4bd659f4cfb109ddd",
            "input": "0x",
            "nonce": "2507788",
            "receipt_contract_address": null,
            "receipt_cumulative_gas_used": "19666574",
            "receipt_gas_used": "40963",
            "receipt_root": null,
            "receipt_status": "1",
            "to_address": "0xb060429d14266d06a8be63281205668be823604f",
            "to_address_entity": null,
            "to_address_entity_logo": null,
            "to_address_label": null,
            "transaction_fee": "0.000071135199081778",
            "transaction_index": "204",
            "transfer_index": [
              22499806,
              204,
            ],
            "value": "19946527446256017",
          },
          {
            "block_hash": "0x6f5a476a202ab96d88baca173ff5fcdc93d3b71f3c8a63c173c15c2f5c4215eb",
            "block_number": "22499791",
            "block_timestamp": "2025-05-17T02:29:59.000Z",
            "from_address": "0x95222290dd7278aa3ddd389cc1e1d165cc4bafe5",
            "from_address_entity": null,
            "from_address_entity_logo": null,
            "from_address_label": "beaverbuild",
            "gas": "21000",
            "gas_price": "1722838328",
            "hash": "0xf1bde9b22d4b4bec72cb18a00ce026525edaccbcad014d88700aec856b184b0f",
            "input": "0x",
            "nonce": "2507787",
            "receipt_contract_address": null,
            "receipt_cumulative_gas_used": "14721993",
            "receipt_gas_used": "21000",
            "receipt_root": null,
            "receipt_status": "1",
            "to_address": "0x150bcf49ee8e2bd9f59e991821de5b74c6d876aa",
            "to_address_entity": null,
            "to_address_entity_logo": null,
            "to_address_label": null,
            "transaction_fee": "0.000036179604888",
            "transaction_index": "140",
            "transfer_index": [
              22499791,
              140,
            ],
            "value": "14197545677963695",
          },
          {
            "block_hash": "0x6f5a476a202ab96d88baca173ff5fcdc93d3b71f3c8a63c173c15c2f5c4215eb",
            "block_number": "22499791",
            "block_timestamp": "2025-05-17T02:29:59.000Z",
            "from_address": "0x95222290dd7278aa3ddd389cc1e1d165cc4bafe5",
            "from_address_entity": null,
            "from_address_entity_logo": null,
            "from_address_label": "beaverbuild",
            "gas": "21000",
            "gas_price": "1722838328",
            "hash": "0x2634e75b2a60b9946a011d9381279a894e155f177025819ab327aa94732c935c",
            "input": "0x",
            "nonce": "2507786",
            "receipt_contract_address": null,
            "receipt_cumulative_gas_used": "7694542",
            "receipt_gas_used": "21000",
            "receipt_root": null,
            "receipt_status": "1",
            "to_address": "0xeda4c0f725466ff036b03b2ad532904d6a96473e",
            "to_address_entity": null,
            "to_address_entity_logo": null,
            "to_address_label": null,
            "transaction_fee": "0.000036179604888",
            "transaction_index": "48",
            "transfer_index": [
              22499791,
              48,
            ],
            "value": "2509715807405440",
          },
          {
            "block_hash": "0x22726d88ca2de73efb0d16cfb52faa900f925a14db05baa572ce17b4b46db440",
            "block_number": "22499790",
            "block_timestamp": "2025-05-17T02:29:47.000Z",
            "from_address": "0x95222290dd7278aa3ddd389cc1e1d165cc4bafe5",
            "from_address_entity": null,
            "from_address_entity_logo": null,
            "from_address_label": "beaverbuild",
            "gas": "23100",
            "gas_price": "1604491929",
            "hash": "0xce037459ab47099cbc119c96a20771e3d0c86ea98a38b468252f9c0f224d2aef",
            "input": "0x",
            "nonce": "2507785",
            "receipt_contract_address": null,
            "receipt_cumulative_gas_used": "28621357",
            "receipt_gas_used": "22111",
            "receipt_root": null,
            "receipt_status": "1",
            "to_address": "0x388c818ca8b9251b393131c08a736a67ccb19297",
            "to_address_entity": "Lido",
            "to_address_entity_logo": "https://entities-logos.s3.us-east-1.amazonaws.com/lido.png",
            "to_address_label": "Lido: Execution Layer Rewards Vault",
            "transaction_fee": "0.000035476921042119",
            "transaction_index": "339",
            "transfer_index": [
              22499790,
              339,
            ],
            "value": "34655519203128079",
          },
          {
            "block_hash": "0x30656e57af70c578339c50fff39c8f1dde99c8be368b04103102a49bceeb9159",
            "block_number": "22499780",
            "block_timestamp": "2025-05-17T02:27:47.000Z",
            "from_address": "0x95222290dd7278aa3ddd389cc1e1d165cc4bafe5",
            "from_address_entity": null,
            "from_address_entity_logo": null,
            "from_address_label": "beaverbuild",
            "gas": "21000",
            "gas_price": "1609605014",
            "hash": "0x282766b231f3b007dad397c5995c810445a42d4766c1105dc47ab003acbe75f1",
            "input": "0x",
            "nonce": "2507784",
            "receipt_contract_address": null,
            "receipt_cumulative_gas_used": "33381514",
            "receipt_gas_used": "21000",
            "receipt_root": null,
            "receipt_status": "1",
            "to_address": "0x82254395de08245c5bfb5c898b93dc7d6329e824",
            "to_address_entity": null,
            "to_address_entity_logo": null,
            "to_address_label": null,
            "transaction_fee": "0.000033801705294",
            "transaction_index": "526",
            "transfer_index": [
              22499780,
              526,
            ],
            "value": "22830397014360470",
          },
          {
            "block_hash": "0xbe01137d9f26aa397f90b729b744c4b221d08e60121545441d69a2d4af8a8a81",
            "block_number": "22499779",
            "block_timestamp": "2025-05-17T02:27:35.000Z",
            "from_address": "0x95222290dd7278aa3ddd389cc1e1d165cc4bafe5",
            "from_address_entity": null,
            "from_address_entity_logo": null,
            "from_address_label": "beaverbuild",
            "gas": "21000",
            "gas_price": "1737611264",
            "hash": "0x3000067da458e52576b4d5a93eddafa50450a28ec2c58e69665e3cdb8d6c665f",
            "input": "0x",
            "nonce": "2507783",
            "receipt_contract_address": null,
            "receipt_cumulative_gas_used": "7391816",
            "receipt_gas_used": "21000",
            "receipt_root": null,
            "receipt_status": "1",
            "to_address": "0xa554965fcd0d9493313e2eafa27eef5b058336f4",
            "to_address_entity": null,
            "to_address_entity_logo": null,
            "to_address_label": null,
            "transaction_fee": "0.000036489836544",
            "transaction_index": "86",
            "transfer_index": [
              22499779,
              86,
            ],
            "value": "30802051523371331",
          },
          {
            "block_hash": "0x2ad04c9a1545907e58a49d3ef22938e3741bdeb6c1c2909bbfb066fc75b6a679",
            "block_number": "22499777",
            "block_timestamp": "2025-05-17T02:27:11.000Z",
            "from_address": "0x95222290dd7278aa3ddd389cc1e1d165cc4bafe5",
            "from_address_entity": null,
            "from_address_entity_logo": null,
            "from_address_label": "beaverbuild",
            "gas": "22111",
            "gas_price": "1765698185",
            "hash": "0x8748be993fa803eae43aa7c340f58ba4490d95db5835994bfec9a46d5836ee45",
            "input": "0x",
            "nonce": "2507782",
            "receipt_contract_address": null,
            "receipt_cumulative_gas_used": "14337400",
            "receipt_gas_used": "22111",
            "receipt_root": null,
            "receipt_status": "1",
            "to_address": "0x388c818ca8b9251b393131c08a736a67ccb19297",
            "to_address_entity": "Lido",
            "to_address_entity_logo": "https://entities-logos.s3.us-east-1.amazonaws.com/lido.png",
            "to_address_label": "Lido: Execution Layer Rewards Vault",
            "transaction_fee": "0.000039041352568535",
            "transaction_index": "131",
            "transfer_index": [
              22499777,
              131,
            ],
            "value": "41380118006788520",
          },
          {
            "block_hash": "0xab7c55292a595187f755d072db80437d82e657fc7805609c8be40befab05e8dd",
            "block_number": "22499775",
            "block_timestamp": "2025-05-17T02:26:47.000Z",
            "from_address": "0x95222290dd7278aa3ddd389cc1e1d165cc4bafe5",
            "from_address_entity": null,
            "from_address_entity_logo": null,
            "from_address_label": "beaverbuild",
            "gas": "21000",
            "gas_price": "1747059094",
            "hash": "0x54bb0326d381efb99ecf0ebd40c3d8f207b29db78f33784402236057c4106299",
            "input": "0x",
            "nonce": "2507781",
            "receipt_contract_address": null,
            "receipt_cumulative_gas_used": "18411946",
            "receipt_gas_used": "21000",
            "receipt_root": null,
            "receipt_status": "1",
            "to_address": "0x4ccdb67369f606b22fac08da95b9409376b1545e",
            "to_address_entity": null,
            "to_address_entity_logo": null,
            "to_address_label": null,
            "transaction_fee": "0.000036688240974",
            "transaction_index": "163",
            "transfer_index": [
              22499775,
              163,
            ],
            "value": "82454841575858358",
          },
          {
            "block_hash": "0x5d893ac6b0ac868c3fb3ef122223de57e1452b1de931cfdda339af8f3a3f0e79",
            "block_number": "22499770",
            "block_timestamp": "2025-05-17T02:25:47.000Z",
            "from_address": "0x95222290dd7278aa3ddd389cc1e1d165cc4bafe5",
            "from_address_entity": null,
            "from_address_entity_logo": null,
            "from_address_label": "beaverbuild",
            "gas": "21000",
            "gas_price": "1684804833",
            "hash": "0x4485849faef92e65a190184a8711edd335831505debf629fcabf865f1852a5dc",
            "input": "0x",
            "nonce": "2507780",
            "receipt_contract_address": null,
            "receipt_cumulative_gas_used": "19572788",
            "receipt_gas_used": "21000",
            "receipt_root": null,
            "receipt_status": "1",
            "to_address": "0xe688b84b23f322a994a53dbf8e15fa82cdb71127",
            "to_address_entity": null,
            "to_address_entity_logo": null,
            "to_address_label": "Fee Recipient: 0xe68...127",
            "transaction_fee": "0.000035380901493",
            "transaction_index": "172",
            "transfer_index": [
              22499770,
              172,
            ],
            "value": "18241054333135448",
          },
          {
            "block_hash": "0x5d893ac6b0ac868c3fb3ef122223de57e1452b1de931cfdda339af8f3a3f0e79",
            "block_number": "22499770",
            "block_timestamp": "2025-05-17T02:25:47.000Z",
            "from_address": "0x95222290dd7278aa3ddd389cc1e1d165cc4bafe5",
            "from_address_entity": null,
            "from_address_entity_logo": null,
            "from_address_label": "beaverbuild",
            "gas": "21000",
            "gas_price": "1684804833",
            "hash": "0x5700fee5aac81753087913ae92416a40e8673cebcbd918ba4d2aeac9c0f296b2",
            "input": "0x",
            "nonce": "2507779",
            "receipt_contract_address": null,
            "receipt_cumulative_gas_used": "13721972",
            "receipt_gas_used": "21000",
            "receipt_root": null,
            "receipt_status": "1",
            "to_address": "0x555ce236c0220695b68341bc48c68d52210cc35b",
            "to_address_entity": null,
            "to_address_entity_logo": null,
            "to_address_label": null,
            "transaction_fee": "0.000035380901493",
            "transaction_index": "109",
            "transfer_index": [
              22499770,
              109,
            ],
            "value": "781397149190667",
          },
          {
            "block_hash": "0x29667d1cfebc282df6868377a0475fff100e9185fb3e7ecb39f3503d75f8ed03",
            "block_number": "22499769",
            "block_timestamp": "2025-05-17T02:25:35.000Z",
            "from_address": "0x95222290dd7278aa3ddd389cc1e1d165cc4bafe5",
            "from_address_entity": null,
            "from_address_entity_logo": null,
            "from_address_label": "beaverbuild",
            "gas": "21000",
            "gas_price": "1579690927",
            "hash": "0x072e4576287afde00288829c17d52046f046aeb9c9997a207c3d61477a6b63b2",
            "input": "0x",
            "nonce": "2507778",
            "receipt_contract_address": null,
            "receipt_cumulative_gas_used": "27581876",
            "receipt_gas_used": "21000",
            "receipt_root": null,
            "receipt_status": "1",
            "to_address": "0xeea3fc1efc3463a3a15dd9bca169829f048ce371",
            "to_address_entity": null,
            "to_address_entity_logo": null,
            "to_address_label": null,
            "transaction_fee": "0.000033173509467",
            "transaction_index": "339",
            "transfer_index": [
              22499769,
              339,
            ],
            "value": "38613820931500652",
          },
          {
            "block_hash": "0x2dba86ac768c710975e11459fc198d00cdc836b501ca0147049a8c2b49b5595b",
            "block_number": "22499767",
            "block_timestamp": "2025-05-17T02:25:11.000Z",
            "from_address": "0x95222290dd7278aa3ddd389cc1e1d165cc4bafe5",
            "from_address_entity": null,
            "from_address_entity_logo": null,
            "from_address_label": "beaverbuild",
            "gas": "29683",
            "gas_price": "1637830318",
            "hash": "0xad613bd68588f05eda9e7b2d4e7d0a8a1de4ee62eaefd1755620a9a44a2c0458",
            "input": "0x",
            "nonce": "2507777",
            "receipt_contract_address": null,
            "receipt_cumulative_gas_used": "18425089",
            "receipt_gas_used": "29683",
            "receipt_root": null,
            "receipt_status": "1",
            "to_address": "0x6be457e04092b28865e0cba84e3b2cfa0f871e67",
            "to_address_entity": null,
            "to_address_entity_logo": null,
            "to_address_label": null,
            "transaction_fee": "0.000048615717329194",
            "transaction_index": "160",
            "transfer_index": [
              22499767,
              160,
            ],
            "value": "45685764135994573",
          },
        ],
      }
    `);
  });
});
